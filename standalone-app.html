<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>SE331 Vue Shopping Cart</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .nav-bar {
            height: 50px;
            background-color: #f4f4f4;
            margin-bottom: 20px;
        }
        .cart {
            float: right;
            padding: 10px;
            background-color: #e9e9e9;
            border-radius: 4px;
        }
        .product-display {
            clear: both;
            margin-top: 20px;
        }
        .product-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .product-image {
            flex-shrink: 0;
        }
        .product-image img {
            max-width: 200px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .out-of-stock-img {
            opacity: 0.5;
        }
        .product-info {
            flex: 1;
        }
        .product-info h1 {
            margin-top: 0;
        }
        .color-circle {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 10px;
            cursor: pointer;
        }
        .button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 4px;
        }
        .disabledButton {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .product-review {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
        }
        .review-item {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 4px;
        }
        .review-input, .review-select, .review-textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
    </style>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="app">
        <div class="nav-bar"></div>  <!-- 导航栏占位 -->
        <div class="cart">Cart({{ cart }})</div>
        
        <!-- Product Display -->
        <div class="product-display">
            <div class="product-container">
                <div class="product-image">
                    <img :src="image" :class="{ 'out-of-stock-img': !inStock }">
                </div>
            </div>
            <div class="product-info">
                <h1>{{ title }}</h1>
                <p v-if="inStock > 10">In Stock</p>
                <p v-else-if="inStock <= 10 && inStock > 0">Almost out of Stock</p>
                <p v-else>Out of Stock</p>
                <ul>
                    <li v-for="detail in details" :key="detail">{{ detail }}</li>
                </ul>
                <div v-for="(variant, index) in variants" :key="variant.id" @mouseover="updateVariant(index)" 
                    class="color-circle" :style="{ backgroundColor: getColorCode(variant.color) }"></div>
                <button class="button" :disabled="!inStock" @click="addToCart" :class="{ disabledButton: !inStock }">Add To Cart</button>
            </div>
        </div>
        
        <!-- Product Reviews -->
        <div class="product-review">
            <h3>Reviews</h3>
            <div v-if="reviews.length === 0">No reviews yet. Be the first to review this product!</div>
            <div v-else class="review-list">
                <div v-for="(review, index) in reviews" :key="index" class="review-item">
                    <p class="review-name">{{ review.name }}</p>
                    <p class="review-rating">Rating: {{ '★'.repeat(review.rating) }}</p>
                    <p class="review-comment">{{ review.comment }}</p>
                </div>
            </div>
            
            <div class="review-form">
                <h4>Add a Review</h4>
                <input v-model="name" placeholder="Your name" class="review-input">
                <select v-model="rating" class="review-select">
                    <option value="1">1 Star</option>
                    <option value="2">2 Stars</option>
                    <option value="3">3 Stars</option>
                    <option value="4">4 Stars</option>
                    <option value="5">5 Stars</option>
                </select>
                <textarea v-model="comment" placeholder="Your review" class="review-textarea"></textarea>
                <button @click="submitReview" class="button">Submit Review</button>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, computed } = Vue;
        
        const app = createApp({
            setup() {
                // Product data
                const product = ref('Boots');
                const brand = ref('SE 331');
                const details = ref([
                    '50% cotton',
                    '30% wool',
                    '20% polyester'
                ]);
                const variants = ref([
                    { id: 2234, color: 'green', image: './assets/images/socks_green.jpg', quantity: 50 },
                    { id: 2235, color: 'blue', image: './assets/images/socks_blue.jpg', quantity: 0 }
                ]);
                const selectedVariant = ref(0);
                const cart = ref(0);
                
                // Review data
                const reviews = ref([]);
                const name = ref('');
                const rating = ref(5);
                const comment = ref('');
                
                // Helper function to convert color names to proper CSS color codes
                function getColorCode(colorName) {
                    const colorMap = {
                        'green': '#228B22',
                        'blue': '#4169E1'
                    };
                    return colorMap[colorName] || colorName;
                }
                
                // Methods
                function updateVariant(index) {
                    selectedVariant.value = index;
                }
                
                function addToCart() {
                    cart.value += 1;
                }
                
                function submitReview() {
                    if (name.value && comment.value) {
                        reviews.value.push({
                            name: name.value,
                            rating: parseInt(rating.value),
                            comment: comment.value
                        });
                        // Reset form
                        name.value = '';
                        comment.value = '';
                        rating.value = 5;
                    } else {
                        alert('Please enter your name and comment');
                    }
                }
                
                // Computed properties
                const title = computed(() => {
                    return brand.value + ' ' + product.value;
                });
                
                const image = computed(() => {
                    return variants.value[selectedVariant.value].image;
                });
                
                const inStock = computed(() => {
                    return variants.value[selectedVariant.value].quantity;
                });
                
                return {
                    // Product properties
                    title,
                    image,
                    inStock,
                    details,
                    variants,
                    cart,
                    updateVariant,
                    addToCart,
                    getColorCode,
                    // Review properties
                    reviews,
                    name,
                    rating,
                    comment,
                    submitReview
                };
            }
        });
        
        app.mount('#app');
        console.log('Vue application mounted successfully');
    </script>
</body>
</html>